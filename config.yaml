# geo configuration file
# Programmatic updates (e.g., --add-place) will reformat this file

schema_version: 1

# Logging configuration
logging:
  log_file: geo.log
  console_level: WARNING
  file_mode: w
  suppress_cdsapi: true
  cds_warnings_in_verbose: true
  suppress_root_logger: true
  third_party_log_level: WARNING

# Grid layout configuration
grid:
  # Maximum automatic grid size (rows x columns)
  # Used when no --grid option is specified
  # Locations exceeding this will be batched into multiple images
  max_auto_rows: 4
  max_auto_cols: 6

# Retrieval tuning configuration
retrieval:
  # Geographic half-width of retrieval box in degrees around each location
  half_box_deg: 0.25
  # Maximum allowed nearest-time offset between requested local noon and ERA5 selected UTC time
  max_nearest_time_delta_minutes: 30
  # For short date ranges (days <= threshold), fetch month chunks instead of full years
  month_fetch_day_span_threshold: 62
  # Hourly precipitation threshold (mm) counted as a "wet" hour for wet_hours_per_day
  wet_hour_threshold_mm: 1.0
  # Per-measure retrieval strategy
  # fetch_mode values: auto | monthly | yearly
  # daily_source values: hourly | timeseries | daily_statistics (precipitation only)
  measures:
    noon_temperature:
      fetch_mode: auto
      daily_source: timeseries  # hourly | timeseries
    daily_precipitation:
      fetch_mode: auto
      daily_source: timeseries  # hourly | timeseries | daily_statistics
    daily_solar_radiation_energy:
      fetch_mode: auto
      daily_source: timeseries  # hourly | timeseries

# Runtime path defaults
runtime_paths:
  cache_dir: era5_cache
  data_cache_dir: data_cache
  out_dir: output
  settings_file: geo_plot/settings.yaml

# Large places dataset is stored separately for maintainability
places_file: places.yaml

# Plotting behaviour configuration
plotting:
  # Measure display labels and units used in templated plot text
  measures:
    noon_temperature:
      overall_title: "Noon Temperature ({year_range})"
      label: "Mid-Day Temperature"
      unit: "°C"
      colour_mode: y_value  # y_value | colour_value | year
      y_value_column: "temp_C"
      y: {min: null, max: null, step: 10, max_steps: null}
      range_text: "{min_temp_c:.1f}°C to {max_temp_c:.1f}°C; ({min_temp_f:.1f}°F to {max_temp_f:.1f}°F)"
    daily_precipitation:
      overall_title: "Daily Precipitation Hours ({year_range})"
      label: "Wet Hours per Day"
      unit: "h" # Using "h" for hours to keep range text concise; can be expanded to "hours" if desired
      colour_mode: colour_value  # y_value | colour_value | year
      plot_format: "wedges"  # points | wedges
      wedge_width_scale: 1.5  # Relative width of wedges when using "wedges" plot format
      y_value_column: "wet_hours_per_day"
      y: {min: 0, max: 24, step: 2, max_steps: 4}
      range_text: "Max daily precipitation: {max_daily_precip_mm:.1f} mm ({max_daily_precip_in:.2f} in)"
      colour_value_column: "max_hourly_precip_mm"
      colourbar_title: "mm/hr"
    daily_solar_radiation_energy:
      overall_title: "Daily Solar Radiation ({year_range})"
      label: "Daily Solar Radiation"
      unit: "MJ/m²"
      colour_mode: y_value  # y_value | colour_value | year
      y_value_column: "solar_energy_MJ_m2"
      y: {min: 0, max: null, step: 10, max_steps: 4}
      range_text: "{measure_label}: {min_value:.1f} to {max_value:.1f} {measure_unit}"
  # Allowed colormaps for plotting (first entry is used as default fallback)
  valid_colormaps: [turbo, viridis, plasma, inferno, magma, cividis]
  # Matplotlib colormap name used for both colour modes
  colormap: turbo

# Plot text configuration
plot_text:
  # Title patterns (can use {location}, {year_range}, {start_year}, {end_year}, {batch}, {total_batches}, {measure_label}, {measure_key}, {measure_unit})
  single_plot_title: "{location} {measure_label} ({year_range})"
  overall_title: "{measure_label}"
  overall_title_with_batch: "{measure_label} ({year_range}) - Part {batch}/{total_batches}"
  subplot_title: "{location}"
  # Range text shown beneath each polar plot
  # Available placeholders include:
  # {min_value}, {max_value}, {min_y_value}, {max_y_value}, {measure_label}, {measure_unit}, {min_temp_c}, {max_temp_c}, {min_temp_f}, {max_temp_f}
  range_text: "{measure_label}: {min_value:.1f} to {max_value:.1f} {measure_unit}"
  
  # Filename patterns (can use {location}, {list_name}, {start_year}, {end_year}, {batch}, {total_batches}, {measure_label}, {measure_key})
  # Note: {location} will be sanitized (spaces->underscores, commas removed)
  single_plot_filename: "{location}_{measure_key}_{start_year}_{end_year}.png"
  subplot_filename: "{list_name}_{measure_key}_{start_year}_{end_year}.png"
  subplot_filename_with_batch: "{list_name}_{measure_key}_{start_year}_{end_year}_part{batch}of{total_batches}.png"
  
  # Credit and attribution text
  credit: "Climate Data Analysis & Visualisation by Colin Osborne"
  data_source: "Data from: ERA5 via CDS"
  single_plot_credit: "Analysis & visualisation by Colin Osborne"

